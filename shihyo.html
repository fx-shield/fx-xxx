<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FX Shield - Economic Indicator Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Noto+Sans+JP:wght@400;700&display=swap');
        
        :root {
            --shield-gold: #c5a059;
            --shield-blue: #0ea5e9;
            --bg-dark: #020b1a;
        }

        body {
            background-color: var(--bg-dark);
            color: #f8fafc;
            font-family: 'Noto Sans JP', 'Rajdhani', sans-serif;
            background-image: 
                radial-gradient(circle at 50% -20%, #1e3a8a 0%, transparent 70%),
                radial-gradient(circle at 0% 100%, #0c1a3d 0%, transparent 50%),
                radial-gradient(circle at 100% 100%, #0c1a3d 0%, transparent 50%);
            background-attachment: fixed;
        }

        .glass {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .indicator-row {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .indicator-row:hover {
            background: rgba(30, 58, 138, 0.3);
            border-left-color: var(--shield-gold);
        }

        .high-impact {
            background: rgba(239, 68, 68, 0.08);
            border-left-color: #ef4444;
        }

        .loader-shield {
            width: 48px;
            height: 48px;
            border: 3px solid var(--shield-gold);
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            animation: rotation 1s linear infinite;
        }

        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .font-rajdhani { font-family: 'Rajdhani', sans-serif; }

        .bonus-badge {
            background: linear-gradient(90deg, #b45309, #d97706);
            box-shadow: 0 0 15px rgba(217, 119, 6, 0.3);
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div class="max-w-3xl mx-auto">
        <!-- Main Shield Header -->
        <header class="text-center mb-10 relative">
            <div class="inline-block p-4 mb-4 rounded-full bg-slate-900 border-2 border-yellow-600 shadow-2xl">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                </svg>
            </div>
            <h1 class="text-5xl font-bold tracking-widest text-white font-rajdhani uppercase">FX SHIELD</h1>
            <p class="text-yellow-500 font-bold mt-2 uppercase tracking-tighter italic">å …å®Ÿãªãƒ•ã‚¡ãƒ³ãƒ€ãƒ¡ãƒ³ã‚¿ãƒ«ã‚ºãƒ»ã‚¬ãƒ¼ãƒ‰</p>
            <div id="clock" class="mt-4 text-2xl font-mono text-cyan-400">00:00:00</div>
        </header>

        <!-- Command Console -->
        <div class="flex flex-col gap-4 mb-8">
            <div class="grid grid-cols-2 gap-4">
                <button onclick="fetchIndicators('today')" class="bg-yellow-600 hover:bg-yellow-500 text-black font-black py-4 rounded-lg transition-all active:scale-95 text-lg">
                    ä»Šæ—¥ã®æŒ‡æ¨™
                </button>
                <button onclick="fetchIndicators('weekly')" class="glass hover:bg-slate-800 text-yellow-500 font-black py-4 rounded-lg transition-all active:scale-95 border-yellow-900/50 border text-lg">
                    ä»Šé€±ã®é‡è¦æŒ‡æ¨™
                </button>
            </div>
            <button onclick="fetchBonus()" class="w-full bonus-badge hover:brightness-110 text-white font-black py-3 rounded-xl transition-all active:scale-[0.98] border border-yellow-400/30">
                ğŸ XMæœ€æ–°ãƒœãƒ¼ãƒŠã‚¹æƒ…å ±ã‚’ã‚¹ã‚­ãƒ£ãƒ³
            </button>
        </div>

        <!-- Notification/Loading Area -->
        <div id="status-display" class="hidden mb-6 p-6 glass rounded-2xl text-center border-yellow-600/30">
            <span class="loader-shield mb-4"></span>
            <p class="text-yellow-500 font-bold animate-pulse" id="status-text">æƒ…å ±ã‚’ã‚¹ã‚­ãƒ£ãƒ³ä¸­...</p>
        </div>

        <!-- Result Container -->
        <div id="calendar-body" class="space-y-3">
            <div class="p-12 glass rounded-3xl text-center border-dashed border-2 border-slate-700">
                <p class="text-slate-500 mb-2">ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚¹ã‚­ãƒ£ãƒ³ã‚’é–‹å§‹ã—ã¦ãã ã•ã„</p>
                <p class="text-xs text-slate-600 uppercase tracking-widest">AIæ¤œç´¢ã«ã‚ˆã‚‹æœ€æ–°æƒ…å ±ã®å–å¾—</p>
            </div>
        </div>

        <!-- Instructor Branding -->
        <footer class="mt-12 p-8 glass rounded-3xl border-t-2 border-yellow-600/50">
            <div class="flex flex-col md:flex-row items-center justify-between gap-6">
                <div class="text-center md:text-left">
                    <h4 class="text-yellow-500 font-bold mb-1 uppercase">ã€Œ4ç¨®ã®ç¥å™¨ã€ã‚’æ¥µã‚ã‚‹</h4>
                    <p class="text-xs text-slate-400">æ°´å¹³ç·šãƒ»ãƒ€ã‚¦ç†è«–ãƒ»MAãƒ»MTFåˆ†æã§ç›¸å ´ã‚’åˆ¶ã™</p>
                </div>
                <div class="flex gap-4">
                    <div class="px-4 py-2 bg-slate-900 rounded border border-slate-700 text-center min-w-[120px]">
                        <span class="block text-[10px] text-blue-400 font-bold">æœ€å¼·ã®æ¤œè¨¼ã‚½ãƒ•ãƒˆ</span>
                        <span class="text-sm font-bold">Forex Tester 6</span>
                    </div>
                    <div class="px-4 py-2 bg-slate-900 rounded border border-slate-700 text-center min-w-[120px]">
                        <span class="block text-[10px] text-emerald-400 font-bold">æ¨å¥¨ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼</span>
                        <span class="text-sm font-bold">XM Trading</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        const apiKey = ""; // Runtime automatically provides key

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').textContent = now.toLocaleTimeString('ja-JP', { hour12: false });
        }
        setInterval(updateClock, 1000);
        updateClock();

        async function fetchIndicators(mode) {
            const statusDisplay = document.getElementById('status-display');
            const statusText = document.getElementById('status-text');
            const body = document.getElementById('calendar-body');
            
            statusDisplay.classList.remove('hidden');
            statusText.textContent = mode === 'today' ? "æœ¬æ—¥ã®é‡è¦æŒ‡æ¨™ã‚’ã‚¹ã‚­ãƒ£ãƒ³ä¸­..." : "ä»Šé€±ã®ä¸»è¦ã‚¤ãƒ™ãƒ³ãƒˆã‚’èª¿æŸ»ä¸­...";

            const today = new Date().toLocaleDateString('ja-JP');
            const userPrompt = mode === 'today' 
                ? `${today}ã®FXçµŒæ¸ˆæŒ‡æ¨™ï¼ˆç±³ãƒ»æ—¥ãƒ»æ¬§ãƒ»è‹±ï¼‰ã‚’æ¤œç´¢ã—ã¦ã€æ—¥æœ¬èªã§ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚`
                : `${today}ã‹ã‚‰ä»Šé€±æœ«ã¾ã§ã®ã€FXã§æ³¨ç›®ã™ã¹ãã€Œé‡è¦åº¦ãŒé«˜ã„ã€çµŒæ¸ˆæŒ‡æ¨™ã‚’æ—¥æœ¬èªã§ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚`;

            const systemPrompt = `
                ã‚ãªãŸã¯FXãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼å‘ã‘ã®åˆ†æãƒ„ãƒ¼ãƒ«ã€ŒFX Shieldã€ã®AIã§ã™ã€‚
                Google Searchã§æœ€æ–°ã®çµŒæ¸ˆæŒ‡æ¨™ã‚’å–å¾—ã—ã€å¿…ãšæ—¥æœ¬èªã§çµæœã‚’è¿”ã—ã¦ãã ã•ã„ã€‚
                JSONå½¢å¼ã®ã¿å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚è§£èª¬ã¯ä¸è¦ã§ã™ã€‚
                
                {
                  "type": "indicator",
                  "indicators": [
                    { "date": "2/12(æ°´)", "time": "22:30", "country": "ğŸ‡ºğŸ‡¸ ã‚¢ãƒ¡ãƒªã‚«", "name": "æ¶ˆè²»è€…ç‰©ä¾¡æŒ‡æ•°(CPI)", "star": "â˜…â˜…â˜…", "isHigh": true, "prev": "3.1%", "est": "2.9%" }
                  ]
                }
            `;

            await callGemini(userPrompt, systemPrompt);
        }

        async function fetchBonus() {
            const statusDisplay = document.getElementById('status-display');
            const statusText = document.getElementById('status-text');
            
            statusDisplay.classList.remove('hidden');
            statusText.textContent = "XMã®æœ€æ–°ãƒœãƒ¼ãƒŠã‚¹ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚’èª¿æŸ»ä¸­...";

            const userPrompt = `XM Tradingã®ç¾åœ¨ã®æœ€æ–°ãƒœãƒ¼ãƒŠã‚¹æƒ…å ±ï¼ˆå£åº§é–‹è¨­ãƒœãƒ¼ãƒŠã‚¹é¡ã€å…¥é‡‘ãƒœãƒ¼ãƒŠã‚¹ã€ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã‚’æ¤œç´¢ã—ã¦ã¾ã¨ã‚ã¦ãã ã•ã„ã€‚`;
            const systemPrompt = `
                æœ€æ–°ã®XM Tradingã®ãƒœãƒ¼ãƒŠã‚¹æƒ…å ±ã‚’å–å¾—ã—ã€æ—¥æœ¬èªã®JSONã§è¿”ã—ã¦ãã ã•ã„ã€‚
                
                {
                  "type": "bonus",
                  "bonusData": [
                    { "title": "å£åº§é–‹è¨­ãƒœãƒ¼ãƒŠã‚¹", "amount": "13,000å††", "desc": "æœªå…¥é‡‘ã§ãƒˆãƒ¬ãƒ¼ãƒ‰å¯èƒ½" },
                    { "title": "100%å…¥é‡‘ãƒœãƒ¼ãƒŠã‚¹", "amount": "æœ€å¤§$500", "desc": "åˆå›å…¥é‡‘ã«å¯¾ã—ã¦" }
                  ],
                  "lastUpdated": "2025/02/11"
                }
            `;

            await callGemini(userPrompt, systemPrompt);
        }

        async function callGemini(userPrompt, systemPrompt) {
            const body = document.getElementById('calendar-body');
            const statusDisplay = document.getElementById('status-display');

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: userPrompt }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] },
                        tools: [{ "google_search": {} }]
                    })
                });

                const data = await response.json();
                const rawText = data.candidates[0].content.parts[0].text;
                const jsonMatch = rawText.match(/\{[\s\S]*\}/);
                const result = JSON.parse(jsonMatch[0]);
                
                if (result.type === 'indicator') {
                    renderIndicators(result.indicators);
                } else if (result.type === 'bonus') {
                    renderBonus(result);
                }
            } catch (error) {
                console.error(error);
                body.innerHTML = `<div class="p-6 bg-red-900/20 text-red-400 rounded-2xl border border-red-800 text-sm">ã‚¨ãƒ©ãƒ¼ï¼šæƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚</div>`;
            } finally {
                statusDisplay.classList.add('hidden');
            }
        }

        function renderIndicators(items) {
            const body = document.getElementById('calendar-body');
            if (!items || items.length === 0) {
                body.innerHTML = `<div class="text-center py-12 glass rounded-3xl text-slate-500">å¯¾è±¡ã®æŒ‡æ¨™ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</div>`;
                return;
            }

            body.innerHTML = items.map(item => `
                <div class="indicator-row glass p-4 rounded-xl flex items-center gap-4 ${item.isHigh ? 'high-impact' : ''}">
                    <div class="flex flex-col items-center justify-center min-w-[70px]">
                        <span class="text-[10px] text-yellow-500 font-bold">${item.date || ''}</span>
                        <span class="text-xl font-mono font-bold ${item.isHigh ? 'text-red-500' : 'text-slate-300'}">${item.time}</span>
                    </div>
                    <div class="text-2xl">${item.country.split(' ')[0]}</div>
                    <div class="flex-1">
                        <div class="text-xs text-slate-400 font-bold uppercase">${item.country.split(' ')[1] || ''}</div>
                        <div class="text-sm md:text-base font-bold text-slate-100">${item.name}</div>
                        <div class="flex gap-4 mt-1 text-[10px] text-slate-500 font-bold">
                            <span>å‰å›: ${item.prev || '-'}</span>
                            <span>äºˆæƒ³: ${item.est || '-'}</span>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-yellow-500 text-xs font-black tracking-widest">${item.star}</div>
                    </div>
                </div>
            `).join('');
        }

        function renderBonus(data) {
            const body = document.getElementById('calendar-body');
            body.innerHTML = `
                <div class="p-6 glass rounded-3xl border-2 border-yellow-600/50">
                    <div class="flex items-center gap-3 mb-4">
                        <span class="text-2xl">ğŸ</span>
                        <h2 class="text-xl font-bold text-white">XM æœ€æ–°ãƒœãƒ¼ãƒŠã‚¹é€Ÿå ±</h2>
                    </div>
                    <div class="grid gap-3">
                        ${data.bonusData.map(b => `
                            <div class="bg-slate-900/80 p-4 rounded-2xl border border-slate-700">
                                <div class="flex justify-between items-start mb-1">
                                    <span class="text-xs text-yellow-500 font-bold uppercase">${b.title}</span>
                                    <span class="bg-yellow-600 text-black text-[10px] font-black px-2 py-0.5 rounded">HOT</span>
                                </div>
                                <div class="text-2xl font-black text-white">${b.amount}</div>
                                <p class="text-xs text-slate-400 mt-1">${b.desc}</p>
                            </div>
                        `).join('')}
                    </div>
                    <p class="text-[10px] text-center text-slate-500 mt-4 tracking-widest uppercase">
                        æœ€çµ‚ã‚¹ã‚­ãƒ£ãƒ³: ${data.lastUpdated}
                    </p>
                </div>
            `;
        }
    </script>
</body>
</html>
